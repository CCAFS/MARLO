DROP VIEW IF EXISTS `user_permissions`;
CREATE VIEW `user_permissions` AS select `u`.`id` AS `id`,`r`.`acronym` AS `ro_acronym`,`r`.`id` AS `role_id`,replace(`p`.`permission`,'{0}',`cp`.`acronym`) AS `permission`,NULL AS `project_id`,`cp`.`acronym` AS `center_acronym`,`p`.`id` AS `permission_id` from ((((((`users` `u` left join `user_roles` `ro` on((`ro`.`user_id` = `u`.`id`))) join `roles` `r` on((`r`.`id` = `ro`.`role_id`))) join `role_permissions` `rp` on((`rp`.`role_id` = `r`.`id`))) join `permissions` `p` on((`p`.`id` = `rp`.`permission_id`))) join `center_users` `center` on(((`u`.`id` = `center`.`user_id`) and (`center`.`center_id` = `r`.`center_id`)))) join `research_centers` `cp` on((`cp`.`id` = `center`.`center_id`))) where ((`p`.`type` = 0) and (`r`.`id` <> 17)) union select `u`.`id` AS `id`,`r`.`acronym` AS `ro_acronym`,`r`.`id` AS `role_id`,replace(`p`.`permission`,'{0}',`cp`.`acronym`) AS `permission`,NULL AS `project_id`,`cp`.`acronym` AS `center_acronym`,`p`.`id` AS `permission_id` from (((((`users` `u` left join `user_roles` `ro` on((`ro`.`user_id` = `u`.`id`))) join `roles` `r` on((`r`.`id` = `ro`.`role_id`))) join `role_permissions` `rp` on((`rp`.`role_id` = `r`.`id`))) join `permissions` `p` on((`p`.`id` = `rp`.`permission_id`))) join `research_centers` `cp`) where ((`p`.`type` = 0) and (`r`.`id` = 17))
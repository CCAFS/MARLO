DROP VIEW IF EXISTS `user_permissions`;

CREATE  VIEW `user_permissions` AS 
select `u`.`id` AS `id`,`r`.`acronym` AS `ro_acronym`,`r`.`id` AS `role_id`,replace(`p`.`permission`,'{0}',`cp`.`acronym`) AS `permission`,`cp`.`acronym` AS `crp_acronym` from ((((((`users` `u` left join `user_roles` `ro` on((`ro`.`user_id` = `u`.`id`))) join `roles` `r` on((`r`.`id` = `ro`.`role_id`))) join `role_permissions` `rp` on((`rp`.`role_id` = `r`.`id`))) join `permissions` `p` on((`p`.`id` = `rp`.`permission_id`))) join `crp_users` `crp` on(((`u`.`id` = `crp`.`user_id`) and (`crp`.`crp_id` = `r`.`crp_id`)))) join `crps` `cp` on((`cp`.`id` = `crp`.`crp_id`))) where ((`p`.`type` = 0) and (`r`.`id` <> 17)) union select `u`.`id` AS `id`,`r`.`acronym` AS `acronym`,`r`.`id` AS `rolId`,replace(replace(`p`.`permission`,'{0}',`cp`.`acronym`),'{1}','project_id') AS `Name_exp_9`,`cp`.`acronym` AS `crp_acronym` from ((((((`users` `u` join `user_roles` `ro` on((`ro`.`user_id` = `u`.`id`))) join `roles` `r` on((`r`.`id` = `ro`.`role_id`))) join `role_permissions` `rp` on((`rp`.`role_id` = `r`.`id`))) join `permissions` `p` on((`p`.`id` = `rp`.`permission_id`))) join `crp_users` `crp` on(((`u`.`id` = `crp`.`user_id`) and (`crp`.`crp_id` = `r`.`crp_id`)))) join `crps` `cp` on((`cp`.`id` = `crp`.`crp_id`))) where ((`p`.`type` = 1) and (`r`.`id` <> 17)) union select `u`.`id` AS `id`,`r`.`acronym` AS `ro_acronym`,`r`.`id` AS `role_id`,replace(`p`.`permission`,'{0}',`cp`.`acronym`) AS `permission`,`cp`.`acronym` AS `crp_acronym` from (((((`users` `u` left join `user_roles` `ro` on((`ro`.`user_id` = `u`.`id`))) join `roles` `r` on((`r`.`id` = `ro`.`role_id`))) join `role_permissions` `rp` on((`rp`.`role_id` = `r`.`id`))) join `permissions` `p` on((`p`.`id` = `rp`.`permission_id`))) join `crps` `cp`) where ((`p`.`type` = 0) and (`r`.`id` = 17))
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3-array"),require("d3-axis"),require("d3-scale"),require("d3-transition"),require("d3kit"),require("labella")):"function"==typeof define&&define.amd?define(["d3-array","d3-axis","d3-scale","d3-transition","d3kit","labella"],e):"object"==typeof exports?exports.d3KitTimeline=e(require("d3-array"),require("d3-axis"),require("d3-scale"),require("d3-transition"),require("d3kit"),require("labella")):t.d3KitTimeline=e(t.d3,t.d3,t.d3,t.d3,t.d3Kit,t.labella)}(this,function(t,e,i,r,n,a){return function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=7)}([function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),s=(i.n(o),i(3)),l=(i.n(s),i(4)),u=(i.n(l),i(1)),c=(i.n(u),i(5)),d=(i.n(c),i(6)),f=i.n(d),h=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),p=function t(e,i,r){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,i,r)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(r)},b=function(t){return t.w},m=function(t){return t.h},x=function(t){return t},y=function(t){function e(t,i){r(this,e);var a=n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return a.layers.create(["dummy",{main:["axis","link","label","dot"]}]),a.layers.get("main/axis").classed("axis",!0),a.force=new f.a.Force(i.labella),a.updateLabelText=a.updateLabelText.bind(a),a.visualize=a.visualize.bind(a),a.on("data",a.visualize),a.on("options",a.visualize),a.on("resize",a.visualize),a}return a(e,t),h(e,null,[{key:"getDefaultOptions",value:function(){return c.helper.deepExtend(p(e.__proto__||Object.getPrototypeOf(e),"getDefaultOptions",this).call(this),{margin:{left:40,right:20,top:20,bottom:20},initialWidth:400,initialHeight:400,scale:i.i(s.scaleTime)(),domain:void 0,direction:"right",dotRadius:3,formatAxis:x,layerGap:60,labella:{},keyFn:void 0,timeFn:function(t){return t.time},textFn:function(t){return t.text},dotColor:"#222",labelBgColor:"#222",labelTextColor:"#fff",linkColor:"#222",labelPadding:{left:4,right:4,top:3,bottom:2},textYOffset:"0.85em"})}},{key:"getCustomEventNames",value:function(){return["dotClick","dotMouseover","dotMousemove","dotMouseout","dotMouseenter","dotMouseleave","labelClick","labelMouseover","labelMousemove","labelMouseenter","labelMouseleave","labelMouseout"]}}]),h(e,[{key:"resizeToFit",value:function(){var t=this.options(),e=void 0,r=this.force.nodes();switch(t.direction){case"up":e=i.i(u.max)(r,function(t){return Math.abs(t.y)})||0,this.height(e+t.margin.top+t.margin.bottom);break;case"down":e=i.i(u.max)(r,function(t){return Math.abs(t.y+t.dy)})||0,this.height(e+t.margin.top+t.margin.bottom);break;case"left":e=i.i(u.max)(r,function(t){return Math.abs(t.x)})||0,this.width(e+t.margin.left+t.margin.right);break;case"right":e=i.i(u.max)(r,function(t){return Math.abs(t.x+t.dx)})||0,this.width(e+t.margin.left+t.margin.right)}return this}},{key:"updateLabelText",value:function(t,e,i){var r=this.options();return i=i?c.helper.functor(i):x,t.text(function(t){return r.textFn(i(t))}).attr("dy",r.textYOffset).attr("x",r.labelPadding.left).attr("y",r.labelPadding.top),Object.keys(e).forEach(function(r){var n=e[r];t.style(r,function(t,e){return n(i(t),e)})}),t}},{key:"drawAxes",value:function(){var t=this.options(),e=void 0;switch(t.direction){case"right":this.axis=i.i(o.axisLeft)(),e="translate(0,0)";break;case"left":this.axis=i.i(o.axisRight)(),e="translate("+this.getInnerWidth()+",0)";break;case"up":this.axis=i.i(o.axisBottom)(),e="translate(0,"+this.getInnerHeight()+")";break;case"down":this.axis=i.i(o.axisTop)(),e="translate(0,0)"}return this.layers.get("main").attr("transform",e),(t.formatAxis||x)(this.axis.scale(t.scale)),this.layers.get("main/axis").call(this.axis),this}},{key:"drawDots",value:function(t){var e=this.options(),i=function(t){return e.scale(e.timeFn(t))},r=this.layers.get("main/dot").selectAll("circle.dot").data(t,e.keyFn),n="left"===e.direction||"right"===e.direction?"cy":"cx";return r.enter().append("circle").classed("dot",!0).on("click",this.dispatchAs("dotClick")).on("mouseover",this.dispatchAs("dotMouseover")).on("mousemove",this.dispatchAs("dotMousemove")).on("mouseout",this.dispatchAs("dotMouseout")).on("mouseenter",this.dispatchAs("dotMouseenter")).on("mouseleave",this.dispatchAs("dotMouseleave")).style("fill",e.dotColor).attr("r",e.dotRadius).attr(n,i),r.transition().style("fill",e.dotColor).attr("r",e.dotRadius).attr(n,i),r.exit().remove(),this}},{key:"drawLabels",value:function(t,e){function r(t){switch(n.direction){case"right":return"translate("+t.x+","+(t.y-t.dy/2)+")";case"left":return"translate("+(t.x+a-t.w)+","+(t.y-t.dy/2)+")";case"up":case"down":return"translate("+(t.x-t.dx/2)+","+t.y+")"}}var n=this.options(),a=void 0;a="left"===n.direction||"right"===n.direction?i.i(u.max)(t,b):i.i(u.max)(t,m);var o=new f.a.Renderer({nodeHeight:a,layerGap:n.layerGap,direction:n.direction});o.layout(t);var s=c.helper.functor(n.labelBgColor),l=c.helper.functor(n.linkColor),d=this.layers.get("main/label").selectAll("g.label-g").data(t,n.keyFn?function(t){return n.keyFn(t.data)}:void 0),h=d.enter().append("g").classed("label-g",!0).on("click",this.dispatchAs("labelClick")).on("mouseover",this.dispatchAs("labelMouseover")).on("mousemove",this.dispatchAs("labelMousemove")).on("mouseenter",this.dispatchAs("labelMouseenter")).on("mouseleave",this.dispatchAs("labelMouseleave")).on("mouseout",this.dispatchAs("labelMouseout")).attr("transform",r);h.append("rect").classed("label-bg",!0).attr("rx",2).attr("ry",2).attr("width",b).attr("height",m).style("fill",function(t){return s(t.data)}),h.append("text").classed("label-text",!0).call(this.updateLabelText,e,function(t){return t.data});var p=d.transition().attr("transform",r);p.select("rect").attr("width",b).attr("height",m).style("fill",function(t){return s(t.data)}),p.select("text.label-text").call(this.updateLabelText,e,function(t){return t.data}),d.exit().remove();var x=this.layers.get("main/link").selectAll("path.link").data(t,n.keyFn?function(t){return n.keyFn(t.data)}:void 0);return x.enter().append("path").classed("link",!0).attr("d",function(t){return o.generatePath(t)}).style("stroke",function(t){return l(t.data)}).style("fill","none"),x.transition().attr("d",function(t){return o.generatePath(t)}).style("stroke",function(t){return l(t.data)}),x.exit().remove(),this}},{key:"visualize",value:function(){var t=this;if(this.hasData()&&this.hasNonZeroArea()){var e=this.data()||[],r=this.options();this.force=new f.a.Force(r.labella),r.domain?r.scale.domain(r.domain):r.scale.domain(i.i(u.extent)(e,r.timeFn)).nice(),r.scale.range([0,"left"===r.direction||"right"===r.direction?this.getInnerHeight():this.getInnerWidth()]);var n=c.helper.extend({},r.textStyle);Object.keys(n).forEach(function(t){n[t]=c.helper.functor(n[t])}),n.fill=n.fill||c.helper.functor(r.labelTextColor);var a=this.layers.get("dummy").append("text").classed("label-text",!0),o=function(t){return r.scale(r.timeFn(t))},s=e.map(function(e){var i=a.call(t.updateLabelText,n,e).node().getBBox(),s=i.width+r.labelPadding.left+r.labelPadding.right,l=i.height+r.labelPadding.top+r.labelPadding.bottom,u=new f.a.Node(o(e),"left"===r.direction||"right"===r.direction?l:s,e);return u.w=s,u.h=l,u});return a.remove(),this.force.options(r.labella).nodes(s).compute(),this.drawAxes(),this.drawDots(e),this.drawLabels(this.force.nodes(),n),this}}}]),e}(c.SvgChart);e.default=y},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e){t.exports=i},function(t,e){t.exports=r},function(t,e){t.exports=n},function(t,e){t.exports=a},function(t,e,i){t.exports=i(0)}])});